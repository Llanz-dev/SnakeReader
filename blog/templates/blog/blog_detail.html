{% extends 'base.html' %}
{% load static %}
{% load widget_tweaks %}


{% block file_css %}
<link rel="stylesheet" href="{% static 'blog/styles/blog_detail.css' %}">
{% endblock file_css %}


{% block title %}
Blog
{% endblock title %}


{% block content %}

<div class="container-md">    
    {% for article in articles %}
        {{ article }}
    {% endfor %}        
</div>

<div class="container-md mt-3">
    <div class="row">
        <div class="col-md-10">
            <h1>{{ specific_article.title|capfirst }}</h1>
            <p class="fw-bold"><a href="{% url 'blog:author' profile_author.user_slug %}" class="text-decoration-none text-success">{{ specific_article.author.username }}</a>
                |
                {{ specific_article.date|date:'F d, o' }}</p>
            <img src="{{ specific_article.heading_img.url }}" alt="blog-image" class="img-fluid">
            {% if specific_article.intro %}
                <p class="fst-italic mt-3 fs-5">{{ specific_article.intro }}</p>
            {% endif %}

            <div class="lh-base fs-4">
                {{ specific_article.body | safe }}
            </div>
        </div>
    </div>
</div>

<!-- Author -->
<div class="container-fluid author-background-color p-5 mt-5">
    <div class="container-md">
        <div class="row d-flex">
            <div class="col-xl-2 col-lg-4 col-md-4 mb-xl-0 mb-lg-0 mb-md-0 mb-sm-5 blog-info-div">                
                    <img src="{{ profile_author.profile_picture.url }}" alt="Author image" class="user-pic rounded">                                                 
            </div>
            <div class="col-xl-10 col-lg-8 col-md-8 flex-fill">
                <p class="fw-bold"><a href="{% url 'blog:author' profile_author.user_slug %}" class="text-decoration-none text-success">{{ profile_author.user.username }}</a> </p>
                <p>{{ profile_author.job_description }}</p>
                <a href="{% url 'blog:author' profile_author.user_slug %}" class="btn btn-success">MORE BLOGS BY {{ profile_author.user.username|upper }}</a>
            </div>
        </div>
    </div>
</div>

<!-- Comments -->
<div class="container mt-3">
    <h3 class="fw-bold">Top comments ({{ specific_article.comments.all.count }})</h3>    
    <a href="{% url 'blog:add_comment' specific_article.slug %}" class="btn btn-sm btn-success">Add comment</a>
    <div class="col-md-6 p-3 bg-light mt-3">        
    {% for comment in specific_article.comments.all %}
        <b class="my-2">            
            <a href="{% url 'blog:author' comment.author_profile.user_slug %}" class="text-decoration-none text-success">{{ comment.author_profile.user.username }}</a> - {{ comment.date_added }}</b>                
        <div class="border p-2 my-2">
            {{ comment.body }}
           <br>           
           {% if comment.author_profile.user == request.user %}
            <div class="mt-2">
                <a href="{% url 'blog:delete_comment' comment.pk specific_article.slug %}" class="btn btn-sm btn-danger">Delete</a>
                <a href="{% url 'blog:edit_comment' comment.pk specific_article.slug %}" class="btn btn-sm btn-warning">Edit</a>
            </div>
           {% endif %}     
           <p></p>       
       </div>
    {% endfor %}
    </div>
</div>

{% endblock content %}